<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Favorites</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Manrope -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Manrope', sans-serif; background-color: #020617; } /* Slate-950 */
        
        /* Fade In Animation */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-300 min-h-screen pb-10">

    <!-- Header & Back Button -->
    <div class="sticky top-0 z-50 bg-[#020617]/90 backdrop-blur-md border-b border-white/5 px-4 py-4 flex items-center gap-4">
        <a href="index.html" class="w-10 h-10 flex items-center justify-center rounded-full bg-white/5 hover:bg-white/10 border border-white/10 transition-all active:scale-95">
            <i class="fa-solid fa-arrow-left text-white"></i>
        </a>
        <h1 class="text-xl font-bold text-white tracking-wide">My Collection ❤️</h1>
    </div>

    <!-- Content Grid -->
    <div class="px-4 mt-6">
        <div id="fav-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
            <!-- Items Javascript se aayenge -->
        </div>

        <!-- Empty State (Hidden by default) -->
        <div id="empty-msg" class="hidden flex-col items-center justify-center mt-20 text-center opacity-50">
            <div class="w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mb-4">
                <i class="fa-regular fa-heart text-3xl text-slate-500"></i>
            </div>
            <h3 class="text-lg font-bold text-white">No favorites yet</h3>
            <p class="text-sm text-slate-500 mt-1">Start adding books to your collection.</p>
            <a href="index.html" class="mt-6 px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-bold hover:bg-indigo-500 transition">Browse Books</a>
        </div>
    </div>

    <script>
        // --- LOGIC ---

        function loadFavorites() {
            // Local Storage se data uthao
            const favs = JSON.parse(localStorage.getItem('favs')) || [];
            const grid = document.getElementById('fav-grid');
            const emptyMsg = document.getElementById('empty-msg');

            grid.innerHTML = '';

            // Agar koi favorite nahi hai
            if (favs.length === 0) {
                emptyMsg.classList.remove('hidden');
                emptyMsg.classList.add('flex');
                return;
            } else {
                emptyMsg.classList.add('hidden');
                emptyMsg.classList.remove('flex');
            }

            // Books Render karo
            favs.forEach((book, index) => {
                // Animation delay for stagger effect
                const delay = index * 50; 
                
                grid.innerHTML += `
                <div class="fade-in relative group" style="animation-delay: ${delay}ms">
                    <!-- Card Container -->
                    <div class="relative w-full aspect-[2/3] rounded-xl overflow-hidden border border-white/10 bg-slate-900 shadow-lg"
                         onclick="location.href='details.html?id=${book.id}'">
                        
                        <img src="${book.poster_url}" class="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-105 transition-all duration-500 cursor-pointer">
                        
                        <!-- Gradient Overlay -->
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60"></div>

                        <!-- Remove Button (Trash Icon) -->
                        <button onclick="removeFav(event, ${book.id})" 
                            class="absolute top-2 right-2 w-8 h-8 flex items-center justify-center rounded-full bg-black/60 backdrop-blur-md text-red-400 border border-red-500/30 hover:bg-red-500 hover:text-white transition-all z-20 active:scale-90">
                            <i class="fa-solid fa-trash-can text-xs"></i>
                        </button>
                    </div>

                    <!-- Title -->
                    <h3 class="mt-3 text-sm font-semibold text-white truncate cursor-pointer hover:text-indigo-400 transition-colors"
                        onclick="location.href='details.html?id=${book.id}'">
                        ${book.title}
                    </h3>
                </div>
                `;
            });
        }

        // --- REMOVE LOGIC ---
        function removeFav(event, id) {
            // Stop bubbling (taaki details page na khul jaye jab delete dabaye)
            event.stopPropagation();

            if(confirm('Remove from favorites?')) {
                let favs = JSON.parse(localStorage.getItem('favs')) || [];
                // Filter karke wo book hata do jiska ID match ho raha hai
                favs = favs.filter(b => b.id != id);
                
                // Wapis save karo
                localStorage.setItem('favs', JSON.stringify(favs));
                
                // UI Refresh karo
                loadFavorites();
            }
        }

        // Page load hote hi function chalao
        loadFavorites();

    </script>
</body>
</html>